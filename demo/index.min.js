!(function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t,n){return(a=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}})()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function u(e){var t="function"==typeof Map?new Map:void 0;return(u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return a(e,arguments,i(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?c(e):t}function s(e,t){return(function(e){if(Array.isArray(e))return e})(e)||(function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n})(e,t)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}function f(e){return(function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}})(e)||(function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)})(e)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance")})()}var h=new WeakMap;function d(e,t){if(void 0!==e&&null!==e){var n=e[t];return"function"==typeof n?n.call():n}}function p(e,t){var n,r,i=t.split(".").reduce(d,e)||"";return n=i,(r=document.createElement("p")).textContent=n,r.innerHTML}function v(e,t){var n=e.children[t];return n||(n={name:t,children:{},observers:[]},e.children[t]=n),n}function y(e,t,n){var r,i,o=(r=n,i=v,function(){return r(i.apply(this,arguments))});return t.split(".").reduce(o,e)}function b(e,t){var n=(function(e){var t=h.get(e);return t||(t={children:{},observers:[]},h.set(e,t)),t})(t),r=!0,i=!1,o=void 0;try{for(var a,u=(function e(t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t.childNodes[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;switch(c.nodeType){case 1:"TEMPLATE"!==c.nodeName&&(n.push.apply(n,f(x(c))),n.push.apply(n,f(e(c))));break;case 3:n.push.apply(n,f(S(c)))}}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n})(e)[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value,l=c.target,s=c.key,d=c.update,p=d.bind(l,t,s);y(n,s,m(t)).observers.push(p),d.call(l,t,s)}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}function m(e){var t=e;return function(e){return e.proxied||(!(function(e,t,n){var r=e[t];Object.defineProperty(e,t,{get:function(){return r},set:function(e){r=e,n()}})})(t,e.name,function e(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.observers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)(0,o.value)()}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}for(var u in t.children)e(t.children[u])}.bind(null,e)),e.proxied=!0),t[e.name]||(t[e.name]={}),t=t[e.name],e}}function g(e,t){this.textContent=p(e,t)}function w(e,t){this.value=p(e,t)}function k(e){return e.split(/({{.+?}})/).map(function(e){return e.startsWith("{{")&&e.endsWith("}}")?{type:1,value:e.slice(2,-2).trim()}:{type:0,value:e}})}function x(e){for(var t=[],n=0,r=Array.from(e.attributes);n<r.length;n++){var i=r[n],o=!0,a=!1,u=void 0;try{for(var c,l=k(i.value)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var s=c.value;1===s.type&&t.push({target:i,key:s.value,update:w})}}catch(e){a=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw u}}}return t}function S(e){var t=k(e.textContent);if(1===t.length&&0===t[0].type)return[];var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value,l=document.createTextNode(c.value);e.parentNode.insertBefore(l,e),1===c.type&&n.push({target:l,key:c.value,update:g})}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e.parentNode.removeChild(e),n}function A(e){return function(t){return b(e,t)}}function O(){if(!(this instanceof O))return new O;this.size=0,this.uid=0,this.selectors=[],this.indexes=Object.create(this.indexes),this.activeIndexes=[]}var C=window.document.documentElement,j=C.matches||C.webkitMatchesSelector||C.mozMatchesSelector||C.oMatchesSelector||C.msMatchesSelector;O.prototype.matchesSelector=function(e,t){return j.call(e,t)},O.prototype.querySelectorAll=function(e,t){return t.querySelectorAll(e)},O.prototype.indexes=[];var E=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;O.prototype.indexes.push({name:"ID",selector:function(e){var t;if(t=e.match(E))return t[0].slice(1)},element:function(e){if(e.id)return[e.id]}});var T=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;O.prototype.indexes.push({name:"CLASS",selector:function(e){var t;if(t=e.match(T))return t[0].slice(1)},element:function(e){var t=e.className;if(t){if("string"==typeof t)return t.split(/\s/);if("object"==typeof t&&"baseVal"in t)return t.baseVal.split(/\s/)}}});var M,L=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;O.prototype.indexes.push({name:"TAG",selector:function(e){var t;if(t=e.match(L))return t[0].toUpperCase()},element:function(e){return[e.nodeName.toUpperCase()]}}),O.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}},M="function"==typeof window.Map?window.Map:(function(){function e(){this.map={}}return e.prototype.get=function(e){return this.map[e+" "]},e.prototype.set=function(e,t){this.map[e+" "]=t},e})();var P=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function F(e,t){var n,r,i,o,a,u,c=(e=e.slice(0).concat(e.default)).length,l=t,s=[];do{if(P.exec(""),(i=P.exec(l))&&(l=i[3],i[2]||!l))for(n=0;n<c;n++)if(a=(u=e[n]).selector(i[1])){for(r=s.length,o=!1;r--;)if(s[r].index===u&&s[r].key===a){o=!0;break}o||s.push({index:u,key:a});break}}while(i);return s}function R(e,t){var n,r,i;for(n=0,r=e.length;n<r;n++)if(i=e[n],t.isPrototypeOf(i))return i}function N(e,t){return e.id-t.id}O.prototype.logDefaultIndexUsed=function(){},O.prototype.add=function(e,t){var n,r,i,o,a,u,c,l,s=this.activeIndexes,f=this.selectors;if("string"==typeof e){for(n={id:this.uid++,selector:e,data:t},c=F(this.indexes,e),r=0;r<c.length;r++)o=(l=c[r]).key,(a=R(s,i=l.index))||((a=Object.create(i)).map=new M,s.push(a)),i===this.indexes.default&&this.logDefaultIndexUsed(n),(u=a.map.get(o))||(u=[],a.map.set(o,u)),u.push(n);this.size++,f.push(e)}},O.prototype.remove=function(e,t){if("string"==typeof e){var n,r,i,o,a,u,c,l,s=this.activeIndexes,f={},h=1===arguments.length;for(n=F(this.indexes,e),i=0;i<n.length;i++)for(r=n[i],o=s.length;o--;)if(u=s[o],r.index.isPrototypeOf(u)){if(c=u.map.get(r.key))for(a=c.length;a--;)(l=c[a]).selector!==e||!h&&l.data!==t||(c.splice(a,1),f[l.id]=!0);break}this.size-=Object.keys(f).length}},O.prototype.queryAll=function(e){if(!this.selectors.length)return[];var t,n,r,i,o,a,u,c,l={},s=[],f=this.querySelectorAll(this.selectors.join(", "),e);for(t=0,r=f.length;t<r;t++)for(o=f[t],n=0,i=(a=this.matches(o)).length;n<i;n++)l[(c=a[n]).id]?u=l[c.id]:(u={id:c.id,selector:c.selector,data:c.data,elements:[]},l[c.id]=u,s.push(u)),u.elements.push(o);return s.sort(N)},O.prototype.matches=function(e){if(!e)return[];var t,n,r,i,o,a,u,c,l,s,f,h=this.activeIndexes,d={},p=[];for(t=0,i=h.length;t<i;t++)if(c=(u=h[t]).element(e))for(n=0,o=c.length;n<o;n++)if(l=u.map.get(c[n]))for(r=0,a=l.length;r<a;r++)!d[f=(s=l[r]).id]&&this.matchesSelector(e,s.selector)&&(d[f]=!0,p.push(s));return p.sort(N)};var I=new WeakMap,q=new WeakMap,_=new WeakMap,W=new WeakMap,z=new WeakMap,D=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function U(e,t,n){var r=e[t];return e[t]=function(){return n.apply(e,arguments),r.apply(e,arguments)},e}function H(){_.set(this,!0)}function V(){_.set(this,!0),W.set(this,!0)}function J(){return z.get(this)||null}function $(e,t){D&&Object.defineProperty(e,"currentTarget",{configurable:!0,enumerable:!0,get:t||D.get})}function B(e,t){var n={};return e?(q.has(t)||q.set(t,n),n=q.get(t)):(I.has(t)||I.set(t,n),n=I.get(t)),n}function G(e){var t=e.currentTarget,n=B(1===e.eventPhase,t)[e.type];if(n){var r=(function(e,t,n){var r=[],i=t;do{if(1!==i.nodeType)break;var o=e.matches(i);if(o.length){var a={node:i,observers:o};n?r.unshift(a):r.push(a)}}while(i=i.parentElement);return r})(n,e.target,1===e.eventPhase);if(r.length){U(e,"stopPropagation",H),U(e,"stopImmediatePropagation",V),$(e,J);for(var i=0,o=r.length;i<o&&!_.get(e);i++){var a=r[i];z.set(e,a.node);for(var u=0,c=a.observers.length;u<c&&!W.get(e);u++)a.observers[u].data.call(a.node,e)}z.delete(e),$(e)}}}var K=(function(t){function o(){var t;return e(this,o),(t=l(this,i(o).call(this))).ranConnected=!1,t.observedAttributes={},t.data=new Proxy({},{set:function(e,t,n){if(e[t]=n,this.ranConnected&&this.observedAttributes[t]){var r=!0,i=!1,o=void 0;try{for(var a,u=this.observedAttributes[t][Symbol.iterator]();!(r=(a=u.next()).done);r=!0){(0,a.value)(t,n)}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}}return!0}.bind(c(t))}),t.callbacks={connect:[],attributechange:[],disconnect:[]},t}return r(o,u(HTMLElement)),n(o,[{key:"initTemplate",value:function(e,t){var n=A(o.template(e).content.cloneNode(!0));this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(n(t));var r={document:this.shadowRoot};this.addListener=function(e){var t=e.slice();t.push(r),function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!!r.capture,o=r.document||document,a=B(i,o),u=a[e];u||(u=new O,a[e]=u,o.addEventListener(e,G,i)),u.add(t,n)}.apply(null,t)},this.removeListener=function(e){var t=e.slice();t.push(r),function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=!!r.capture,o=r.document||document,a=B(i,o),u=a[e];u&&(u.remove(t,n),u.size||(delete a[e],o.removeEventListener(e,G,i)))}.apply(null,t)}}},{key:"attributeChangedCallback",value:function(e,t,n){if(!this.ranConnected||n===t||null===n)return!1;for(var r=0,i=Object.entries(this.observedAttributes);r<i.length;r++){s(i[r],1)[0]===e&&(n=this.parseAttribute(n))}this.data[e]!==n&&(this.data[e]=n),this.runCallbacks("attributechange")}},{key:"connectedCallback",value:function(){if(this.isConnected){this.ranConnected=!0;for(var e=0,t=Object.entries(this.observedAttributes);e<t.length;e++){var n=s(t[e],1)[0];this.data[n]=this.parseAttribute(this.getAttribute(n))}if(this.eventListeners){var r=!0,i=!1,o=void 0;try{for(var a,u=this.eventListeners[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;c&&3===c.length&&this.addListener(c)}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}}this.runCallbacks("connect")}}},{key:"disconnectedCallback",value:function(){if(this.ranConnected=!1,this.eventListeners){var e=!0,t=!1,n=void 0;try{for(var r,i=this.eventListeners[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o&&3===o.length&&this.removeListener(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}this.runCallbacks("disconnect")}},{key:"serializeAttribute",value:function(e){return e?"string"==typeof e?e:JSON.stringify(e):null}},{key:"parseAttribute",value:function(e){if(!e)return null;try{return JSON.parse(e)}catch(t){return e}}},{key:"on",value:function(e,t){return this.callbacks[e]?(this.callbacks[e].push(t),!0):(console.log('An event with the name of "'.concat(e,'" is not supported.')),!1)}},{key:"runCallbacks",value:function(e){if(this.callbacks[e]){var t=!0,n=!1,r=void 0;try{for(var i,o=this.callbacks[e][Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;"function"==typeof a&&a()}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}}]),o})();K.init=function(e,t,n){var r=!0,i=!1,o=void 0;try{for(var a,u=t.observedAttributes[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;e.observedAttributes[c]=[]}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}e.initTemplate(n,e.data),Object.assign(e,K.gatherElements(e.shadowRoot,"data-element"))},K.template=function(e){var t=document.createElement("template");return t.innerHTML=e,t},K.gatherElements=function(e,t){var n={},r=e.querySelectorAll("["+t+"]"),i=!0,o=!1,a=void 0;try{for(var u,c=r[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=u.value;n["$"+l.getAttribute(t)]=l}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n},K.stashe=A;var Q='<style> </style> <div class="hostdiv"> <div><span>hello!</span></div> <div></div> <div>{{ replaceme }}! {{ helpme }}</div> <div>{{ dereference.me }}</div> </div> ',X=(function(t){function o(){var t;return e(this,o),t=l(this,i(o).call(this)),K.init(c(t),o,Q),t}return r(o,K),n(o,[{key:"eventListeners",get:function(){return[["click","span",function(e){console.log("hey!")}]]}}],[{key:"observedAttributes",get:function(){return["helpme","replaceme","dereference"]}}]),o})();window.customElements.define("test-component",X);var Y='<template data-element="choiceTpl"> <div class="choice"><input type="radio" name="{{name}}" id="{{id}}" value="{{choice}}"><label for="{{id}}">{{choice}}</label></div> </template> ',Z=(function(t){function o(){var t;return e(this,o),t=l(this,i(o).call(this)),K.init(c(t),o,Y),t.observedAttributes.choices.push(t.renderChoices.bind(c(t))),t.observedAttributes.choice.push(function(e,t){this.setAttribute(e,this.serializeAttribute(t));var n=this.shadowRoot.querySelector("[value="+this.data.choice+"]");n&&(n.checked=!0)}.bind(c(t))),t}return r(o,K),n(o,[{key:"renderChoices",value:function(){var e=this.shadowRoot,t=this.$choiceTpl,n=this.data["in-name"],r=this.data.choices;if(e&&t&&n&&r){e.querySelectorAll(".choice").forEach(function(e){e.remove()});var i=!1,o=!0,a=!1,u=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var s=c.value,f=K.stashe(t.content.cloneNode(!0)),h={};h.id="_"+Math.random().toString(36).substr(2,9),h.name=n,h.choice=s;var d=f(h),p=d.querySelector("input");i||(p.checked=!0,i=!0,this.data.choice=s),e.appendChild(d)}}catch(e){a=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw u}}}}},{key:"eventListeners",get:function(){return[["click","input",function(e){var t=this.shadowRoot.querySelector(":checked");this.data.choice=t.getAttribute("value")}.bind(this)]]}}],[{key:"observedAttributes",get:function(){return["in-name","choices","choice"]}}]),o})();window.customElements.define("in-radio",Z)})();
